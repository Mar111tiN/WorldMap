var acos=Math.acos,asin=Math.asin,atan2=Math.atan2,cos=Math.cos,max=Math.max,min=Math.min,PI=Math.PI,sin=Math.sin,sqrt=Math.sqrt,radians=PI/180,degrees=180/PI;function versor(n){var a=n[0]/2*radians,r=sin(a),s=cos(a),t=n[1]/2*radians,i=sin(t),o=cos(t),e=n[2]/2*radians,c=sin(e),u=cos(e);return[s*o*u+r*i*c,r*o*u-s*i*c,s*i*u+r*o*c,s*o*c-r*i*u]}function cross(n,a){return[n[1]*a[2]-n[2]*a[1],n[2]*a[0]-n[0]*a[2],n[0]*a[1]-n[1]*a[0]]}function dot(n,a){return n[0]*a[0]+n[1]*a[1]+n[2]*a[2]}versor.cartesian=function(n){var a=n[0]*radians,r=n[1]*radians,s=cos(r);return[s*cos(a),s*sin(a),sin(r)]},versor.rotation=function(n){return[atan2(2*(n[0]*n[1]+n[2]*n[3]),1-2*(n[1]*n[1]+n[2]*n[2]))*degrees,asin(max(-1,min(1,2*(n[0]*n[2]-n[3]*n[1]))))*degrees,atan2(2*(n[0]*n[3]+n[1]*n[2]),1-2*(n[2]*n[2]+n[3]*n[3]))*degrees]},versor.delta=function(n,a){var r=cross(n,a),s=sqrt(dot(r,r));if(!s)return[1,0,0,0];var t=acos(max(-1,min(1,dot(n,a))))/2,i=sin(t);return[cos(t),r[2]/s*i,-r[1]/s*i,r[0]/s*i]},versor.multiply=function(n,a){return[n[0]*a[0]-n[1]*a[1]-n[2]*a[2]-n[3]*a[3],n[0]*a[1]+n[1]*a[0]+n[2]*a[3]-n[3]*a[2],n[0]*a[2]-n[1]*a[3]+n[2]*a[0]+n[3]*a[1],n[0]*a[3]+n[1]*a[2]-n[2]*a[1]+n[3]*a[0]]};